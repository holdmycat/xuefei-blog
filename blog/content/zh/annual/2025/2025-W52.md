---
title: "2025 年第 52 周 - 核心架构重构与数值框架落地"
date: 2025-12-30
week: "2025-W52"
tags: ["Unity", "SLG", "Architecture"]
draft: false
---

## 本周总结

本周（2025-12-25 至 2025-12-30）完成了 SLG 双端架构的核心搭建：

### 核心成果

- ✅ **Server-Client 分离架构**：实现了 `DualWorldSceneManager`，解耦了表现层与逻辑层。
- ✅ **Zenject MVVM 落地**：基于 Zenject 实现了 UI 的依赖注入与响应式绑定 (Reactive Binding)。
- ✅ **配置化工作流**：完成了基于 NodeGraph 的 Commander/Squad 可视化编辑。

### 技术亮点

- **Reactive Binding**：解决 UI 初始化时序竞争，确保数据一致性。
- **Strict Animation Locking**：防止 UI 状态机且入时的时序错乱。

### 下周计划

- 推进 Squad/Soldier 的实体生成。
- 完成移动与战斗基础闭环。

## 本周进展

### 2025-12-29（周一）

- ✅ **UI Atlas 系统落地**：实现了 `UIAtlasRepository` 与 `DataLoaderService` 的整合，完成了 Sprite Atlas 的统一加载与管理。
- ✅ **等级系统闭环**：打通了 UI (`CommanderInfoWidget`) -> ViewModel -> Component 的升级 (`LevelUp`) 与重置逻辑。
- ✅ **军团架构重构**：确立了“数据层扁平 (`ShowcaseContext`)，表现层层级 (`ViewModel`)”的架构原则，并实现了 Legion 在 ViewModel 层的聚合展示。
- ✅ **严苛模式验证**：实现了 Strict Animation Locking，防止了 UI 状态机在复杂交互下的时序错乱。
- 📅 **明日计划**: 将军团属性配置化 (SlgLegionAttributesNodeData)，并串联指挥官与军团的数据初始化逻辑。

### 2025-12-28（周日）

- ✅ **UI 架构落地 (MVVM)**：实现了基于 Zenject 的 MVVM 框架，支持嵌套 UI (`CommanderInfoWidget`) 和动态工厂创建。
- ✅ **响应式绑定 (Reactive Binding)**：解决了 UI 初始化时序竞争问题，通过 `OnCommanderAdded` 事件流确保了数据的一致性。
- ✅ **工厂模式实践**：统一了 Scene 对象（通过 `Show()`）与工厂对象的生命周期管理。
- 📅 **明日计划**: 推进 Squad/Soldier 的实体生成与战斗属性数值接入。

### 2025-12-27（周六）

- ✅ **Server-Client 架构深度重构**：将 SceneManager 拆解为 `DualWorldSceneManager` (通用) + `ShowcaseServer/ClientManager` (场景特有)，实现了框架与内容的解耦。
- ✅ **解决 Zenject 绑定冲突**：修复了 Abstract Class 绑定到自身的循环依赖问题，明确了纯 C# 类（构造注入）与 MonoBehaviour（方法注入）的最佳实践。
- ✅ **数值系统升级**：为 `CommanderNumericComponent` 实现了 `LevelUp` 接口，并通过硬编码逻辑打通了属性动态变更的闭环。
- ✅ **日志健康度检查**：通过 Log Analysis 工作流确认了系统启动与关闭的对称性，无内存泄漏风险。
- 📅 **明日计划**: 加载 `UIScene_ShowCaseScene`，联通指挥官属性到 UI，同时可以执行升级和降级操作。

### 2025-12-26（周五）

- ✅ **Commander 架构重构**：完成了 Context Scope 的注入，实现了 Commander 自洽的依赖环境。
- ✅ **可视化配置落地**：完成了基于 NodeGraph 的 Commander/Squad 配置编辑器。
- ✅ **数值架构升级**：引入了 `NumericComponentFactory`，支持动态挂载数值组件。
- ⚠️ **计划调整**: 原定 Squad 生成顺延。

### 2025-12-25（周四）

- ✅ **双端实体生成架构**：完成了基于 ScriptableObject (SO) 的 Server/Client 实体生成。
- ✅ **数据迁移**：完成了 Player 与 Monster 数据向 SO 的迁移。
