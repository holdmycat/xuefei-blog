{{ $pinned := .Site.Data.pinned }}
{{ if $pinned }}
  <section id="pinned" class="pinned-only">
    <div class="pinned-container" data-pinned-gallery>
      <div class="pinned-header">
        <h1 class="pinned-title">{{ $pinned.title }}</h1>
        {{ with $pinned.subtitle }}<p class="pinned-subtitle">{{ . }}</p>{{ end }}
      </div>

      <div class="pinned-grid">
        <div class="pinned-media">
          <div class="pinned-main" data-pinned-main>
            {{ if and $pinned.video (eq $pinned.video.provider "bilibili") }}
              <button class="pinned-video-cover" type="button" data-pinned-play data-bvid="{{ $pinned.video.bvid }}" data-iframe="{{ $pinned.video.iframe_src }}" aria-label="Play video">
                <img src="{{ strings.TrimPrefix "/" $pinned.video.cover | relURL }}" alt="{{ $pinned.title }} video cover" loading="lazy" decoding="async">
                <span class="play-icon" aria-hidden="true"></span>
              </button>
            {{ end }}
          </div>
          <div class="pinned-thumbs">
            {{ if and $pinned.video (eq $pinned.video.provider "bilibili") }}
              <button type="button" class="pinned-thumb pinned-thumb--video active" data-media-type="video" data-bvid="{{ $pinned.video.bvid }}" data-iframe="{{ $pinned.video.iframe_src }}">
                <img src="{{ strings.TrimPrefix "/" $pinned.video.cover | relURL }}" alt="{{ $pinned.title }} video thumbnail" loading="lazy" decoding="async">
                <span class="pinned-thumb-play" aria-hidden="true"></span>
              </button>
            {{ end }}
            {{ range $pinned.gallery }}
              <button type="button" class="pinned-thumb" data-media-type="image" data-src="{{ strings.TrimPrefix "/" . | relURL }}">
                <img src="{{ strings.TrimPrefix "/" . | relURL }}" alt="{{ $pinned.title }} thumbnail" loading="lazy" decoding="async">
              </button>
            {{ end }}
          </div>
        </div>

        <aside class="pinned-info">
          {{ with $pinned.poster }}
            <div class="pinned-poster">
              <img src="{{ strings.TrimPrefix "/" . | relURL }}" alt="{{ $pinned.title }} poster" loading="lazy" decoding="async">
            </div>
          {{ end }}

          {{ with $pinned.description }}
            <div class="pinned-desc">
              <p>{{ . }}</p>
            </div>
          {{ end }}

          {{ if or $pinned.responsibility $pinned.team_size }}
            <div class="pinned-meta-extra">
              {{ with $pinned.responsibility }}
                <div class="meta-row">
                  <span class="label">职责：</span>
                  <span class="value">{{ . }}</span>
                </div>
              {{ end }}
              {{ with $pinned.team_size }}
                <div class="meta-row">
                  <span class="label">项目组人数：</span>
                  <span class="value">{{ . }} 人</span>
                </div>
              {{ end }}
            </div>
          {{ end }}

          {{ with $pinned.period }}
            <div class="pinned-meta">
              <div class="meta-row">
                <div class="meta-k">日期</div>
                <div class="meta-v">{{ . }}</div>
              </div>
            </div>
          {{ end }}

          {{ with $pinned.tags }}
            <div class="pinned-tags">
              {{ range . }}<span class="tag">{{ . }}</span>{{ end }}
            </div>
          {{ end }}

          {{ with $pinned.tech_stack }}
            <div class="pinned-tech">
              <div class="tech-title">技术栈</div>
              <div class="tech-list">
                {{ range . }}<span class="chip">{{ . }}</span>{{ end }}
              </div>
            </div>
          {{ end }}

          <div class="pinned-actions">
            {{ with $pinned.links.steam }}
              {{ if ne . "" }}<a class="btn primary" href="{{ . }}" target="_blank" rel="noopener noreferrer">Steam 页面</a>{{ end }}
            {{ end }}
            {{ if and $pinned.video (eq $pinned.video.provider "bilibili") }}
              <a class="btn" data-open-video href="https://www.bilibili.com/video/{{ $pinned.video.bvid }}" target="_blank" rel="noopener noreferrer">观看视频</a>
            {{ end }}
          </div>
          {{ if and $pinned.video (eq $pinned.video.provider "bilibili") }}
            <p class="pinned-fallback" hidden>若无法嵌入播放，请点击“观看视频”跳转 B 站。</p>
          {{ end }}
        </aside>
      </div>
    </div>
  </section>
{{ end }}
