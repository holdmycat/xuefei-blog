{{ define "main" }}
{{ $pages := where site.RegularPages "Params.lang" site.Language.Lang }}
{{ if eq (len $pages) 0 }}
  {{ $pages = where site.RegularPages "Lang" site.Language.Lang }}
{{ end }}
{{ $paginator := .Paginate $pages }}
{{ $base := replaceRE "/$" "" .Site.BaseURL }}
{{ $lang := $.Site.Language.Lang }}

<section class="hero">
  <div class="hero-label">{{ i18n "latest" }}</div>
  <h1>{{ if .IsHome }}{{ i18n "homeTitle" }}{{ else }}{{ .Title }}{{ end }}</h1>
  {{ with .Description }}<p class="lead">{{ . }}</p>{{ end }}
</section>

<section class="post-list">
  {{ range $paginator.Pages }}
    <article class="post-card">
      <div class="meta">
        <span>{{ .Date.Format "Jan 2, 2006" }}</span>
        {{ with .Params.categories }}
          <span class="dot">â€¢</span>
          {{ range $index, $cat := . }}
            <a href="{{ printf "%s/%s/categories/%s/" $base $lang (urlize $cat) }}" class="pill">{{ $cat }}</a>{{ if lt (add $index 1) (len .) }}{{ end }}
          {{ end }}
        {{ end }}
      </div>
      <h2><a href="{{ printf "%s/%s/posts/%s/" $base .Site.Language.Lang .Slug }}">{{ .Title }}</a></h2>
      <p>{{ with .Summary }}{{ . }}{{ else }}{{ .Plain }}{{ end }}</p>
      {{ with .Params.tags }}
        <div class="tag-row">
          {{ range . }}<a class="tag" href="{{ printf "%s/%s/tags/%s/" $base $lang (urlize .) }}">#{{ . }}</a>{{ end }}
        </div>
      {{ end }}
    </article>
  {{ else }}
    <p>{{ i18n "noPosts" }}</p>
  {{ end }}
</section>

{{ template "partials/pagination.html" . }}
{{ end }}
